|      类别      |                   Doris                   |      Clickhouse      |                             备注                             |
| :------------: | :---------------------------------------: | :------------------: | :----------------------------------------------------------: |
|      类别      |                   Doris                   |      Clickhouse      |                             备注                             |
|    总体架构    |            Share-Nothing + MPP            |         相同         |          方便横向扩展添加节点，并行可以提高处理速度          |
|                |                   列存                    |         相同         |           查询少量列时减少扫描数据量，可以支持压缩           |
|                |           内置分布式协议类似ZAB           |    依赖Zookeeper     |               Master/Follower/Observer节点类型               |
|                |              事务和MVCC机制               |   100万以内原子性    |                      可以保证数据一致性                      |
|                |               支持数据规模                |    单集群 < 10PB     |                        单集群 < 10 PB                        |
|                |                                           |                      |                                                              |
|    导入方式    |          从Kafka导入数据（内置）          |       内置支持       |                  分钟级(1-15分钟)，配置即可                  |
|                |         从HDFS上导入数据（内置）          | 外部通过HTTP接口导入 |                 离线数据或历史数据，配置即可                 |
|                |           分布式Spark/Flink导入           | 外部通过HTTP接口导入 |                         业务方写代码                         |
|                |               本地JDBC/HTTP               |         支持         |           本地代码导入，JDBC少数据量，HTTP大数据量           |
|                |        INSERT INTO ... SELECT ...         |         支持         |          可以把一张维度多的表汇总成另一张维度少的表          |
|                |               数据格式支持                |                      |                       orc/parquet/json                       |
|                |                                           |                      |                                                              |
|    存储架构    |               一级范围分区                |         支持         |                     一般日期天/周/月范围                     |
|                |               二级Hash分桶                |         支持         |                     按ID等分布均匀的字段                     |
|                |                支持多副本                 |         支持         |                 单个节点故障不影响写入和查询                 |
|                |              结构化数据支持               |   结构化、半结构化   |                不支持半结构化/嵌套的数据类型                 |
|                |               压缩格式支持                |      LZ4，ZSTD       |                           LZO，LZ4                           |
|                |                 前缀索引                  |       稀疏索引       |                      36个字节的前缀索引                      |
|                |                 物化视图                  |                      |           支持创建常用维度的物化视图，加快查询速度           |
|                | 支持Bitmap索引精确去重支持HLL索引抽样计算 |   不支持Bitmap索引   |                         可以加快查询                         |
|                |             增量数据后台合并              |                      |                       不影响导入和查询                       |
|                |            支持自动分区（TTL）            |         支持         |                可以指定分区策略，自动创建分区                |
|                |               支持类型转换                |                      |     比如Date/DateTime，float/double → decimal，增加长度      |
|                |         变通的数据更新和删除支持          |                      | 更新：用替换的方式，或用变化量的方式求和删除：用软删除和分区重建（需要外部工具支持） |
|                |                 写入性能                  |                      |                 可以并行写，10M/桶（1万条）                  |
|                |                 读写分离                  |                      |                       支持云存储和读取                       |
|                |                                           |                      |                                                              |
|    计算能力    |                 并发能力                  |                      |            QPS 100/台，要看扫描数据量和计算复杂度            |
|                |                 查询时间                  |                      |             TP99 < 100ms - 1S，要看查询数据大小              |
|                |                 编译执行                  |                      |             可以把多个SQL函数编译成一个方法执行              |
|                |                 谓词下推                  |                      |                可以把Where条件下推到扫描节点                 |
|                |              BroadCast Join               |                      |                 小表广播到大表节点上参与计算                 |
|                |                 Hash Join                 |                      |           类似Spark Shuffle，都分发到同一台服务器            |
|                |               Colocate Join               |                      |            相同ID数据在一台服务器，本地Join速度快            |
|                |                自定义函数                 |                      |                  支持UDF/UDAF，暂不支持UDTF                  |
|                |             查询结果整体缓存              |                      |                             支持                             |
|                |              查询按分区缓存               |                      |                           正在进行                           |
|                |                                           |                      |                                                              |
|     扩展性     |             支持JDBC/ODBC协议             |                      |                        支持多种客户端                        |
|                |                兼容标准SQL                |                      |                        扩展了高级写法                        |
|                |                 容器部署                  |                      |                             支持                             |
|                |               外查MySQL的表               |                      |                             支持                             |
|                |                外查ES的表                 |                      |                             支持                             |
|                |              Spark查JD-OLAP               |                      |                             支持                             |
|                |                查Hive的表                 |                      |                           暂不支持                           |
|                |                                           |                      |                                                              |
|     管理性     |              元数据自动同步               |                      |                       方便上下线服务器                       |
|                |               副本自动均衡                |                      |                      节点故障不影响使用                      |
|                |                 数据备份                  |                      |                        支持备份到HDFS                        |
|                |                监控和报警                 |                      |                     较为完善的监控和后台                     |
|                |             多租户和资源隔离              |                      |          按业务分数据库、分账号，但硬件资源无法隔离          |
|                |                                           |                      |                                                              |
| 权限/安全/审计 |                   权限                    |                      |                 数据库用户和权限控制，表级别                 |
|                |                   审计                    |                      |                          有审计日志                          |
|                |                端到端加密                 |                      |                            不支持                            |
|                |                 网络隔离                  |                      |                             暂无                             |
|                |                                           |                      |                                                              |
|    一些局限    |           没有Update/Delete语法           |                      |                       只支持Append操作                       |
|                |            DDL/DML操作后台异步            |                      |         一般很快，系统繁忙时需要等待，或超时后要重试         |
|                |        跨数据中心数据一致性不完善         |                      |                   目前需要业务方双写来保证                   |
|                |                                           |                      |                                                              |