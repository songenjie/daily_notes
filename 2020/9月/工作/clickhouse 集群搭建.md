clickhouse 

1. 依赖配置 metrics.xml
2. 依赖机器本身性能 如 磁盘inode 数量 





#### 1 机器初始化

1. 重装系统
2. 设置磁盘
3. 导入运维系统
4. 监控 node_exporter 

@使用手册  麻烦添加使用手册



#### 2 集群创建

1. zkip确认
2. ckip确认
3. 集群名称确认
4. 副本数确认
5. 分片数确认
6. 
7. 集群创建



#### 3 集群vip申请

1. 机器域名确认
2. vip 申请



#### 4 文档更新

1. 业务文档更新
2. 集群文档更新







| 序号                                   | 流程                                                         | 环节                                 | 待改进问题和建议                                             | 优先级 | 备注                      |
| :------------------------------------- | :----------------------------------------------------------- | :----------------------------------- | :----------------------------------------------------------- | :----- | :------------------------ |
| 1                                      | 需求沟通确认                                                 |                                      | 痛点：机器资源不足建议：使用共享集群，资源隔离，多租户处理   | P1     | 产品加强介入              |
| 2                                      | （表）模型测试                                               | 确认建表模型和测试数据量             | 痛点：业务无法按照自身需求选择合适的建表模型和测试数据量建议：整理业务场景推荐建表模型文档 To 业务方（业务方使用，比如黄金眼的字典表&自身） | P1/2   |                           |
| 3                                      | （业务）资源申请                                             | 业务需求换算对应的机器资源           | 痛点：当前需要OLAP研发按照业务需求，换算出其需申请的机器资源建议：通过机器资源换算模型，业务输入需求自动换算。（Ps:机器配置不确定，无法给出合理的换算模型）1、根据不同的配置有对应的换算模型2、按瓶颈资源评估3、申请机器：离线/实时机器，CPU、内存、机器磁盘挂载点标准一致 | P1     | 参考Hbase压测看受限子资源 |
| 业务申请机器流程                       | 痛点：当前业务通过邮件，像军亮团队申请资源。1、业务申请资源没有落数据库存储，后续团队无法有效掌握和管控业务资源情况；2、整体流程申请，用户体验不友好。建议：资源申请产品化，初步考虑用BDP流程中心进行业务资源申请入口，但有个问题是如何跟军亮团队打通。资源结算：1、独立集群按照机器算；---机器+服务费（参考adb阿里云）2、共享集群：数据存储/查询算； | P0资源结算方案---低                  | 孟滕                                                         |        |                           |
| 4                                      | 机器配置                                                     | 重装系统                             | 痛点：1、机器管理系统工单处理慢；2、重装慢，或重装过程中机器故障。建议：1、向机器管理系统反馈问题和需求； |        |                           |
| 接入鲲鹏                               | 暂无                                                         |                                      |                                                              |        |                           |
| 磁盘、内存、CPU配置                    | 痛点：磁盘、内存、CPU故障（同上重装系统故障），磁盘少，未装red建议：申请老机器时可以多申请一些（10%~20%），有问题时替换 |                                      |                                                              |        |                           |
| 白泽监控                               | 痛点：已配置监控，ZK\CK告警已配置，系统未配置告警建议：梳理配置告警项--->配置 | P0                                   | 磁盘、内存、CPU等周辉、海波 with哲涵                         |        |                           |
| 5                                      | 新建/运维集群                                                | 集群初始化（admin调鲲鹏---集群管控） | 痛点：当前集群初始化部署仅实现半自动化，依赖人力去鲲鹏操作，配置下发--参考Hbase建议：梳理期待鲲鹏提供的API项，提需求。可通过API传递信息，完成集群初始化自动部署。 | P1     | 高明 with怡燃             |
| 权限配置                               | 痛点：1、1个集群无密码配置；2、当前权限配置很多信息（用户名、密码、IP地址等）完成后，都是由OLAP研发通过咚咚告诉用户；建议：1、该集群配置密码；2、考虑产品化实现信息触达用户，调研参考Mysql等数据库；3、授权配置产品化 | P2                                   |                                                              |        |                           |
| 监控配置                               | 痛点：暂无告警建议：同上机器                                 | P0                                   | 周辉、海波 with哲涵                                          |        |                           |
| 运维管理（扩缩容、数据迁移、数据均衡） | 痛点：1、当前集群扩缩容仅能实现半自动化（同上集群初始化）1.1、**故障替换（节点摘除/替换，建表等）需人为手动—P0**1.2、数据迁移方案需持续优化，例如CK—CK2、数据管理后台、阿波罗功能待完善3、缺乏coordinator和运维工具，现在都是人肉处理建议：1、给鲲鹏提需求（同上集群初始化）；2、确认待完善功能优先级，开发上线。3、集群管控页面，①专用集群用户可以看到自己的集群情况（热力图），并且配置报警规则；②管理员配置管控策略，扩缩容，分片分区等；③用户申请集群。**4、TTL设置、删除数据需要产品化工具 open 业务方操作；** | P0                                   | 高明、恩杰                                                   |        |                           |
| 数据导入                               | 痛点：1、SDK（写入）方案待完善；2、大业务导入存在的问题：①需要几台物理机专门支持导入；②导入工具配置文件产品化；③导入进度展示/异常监控建议：1、继续优化SDK方案，连接集群，监控信息；2、划拨几台（合理）物理机支持，导入工具配置、进度、监控产品化。 | P1                                   |                                                              |        |                           |
| 6                                      | 数据查询/更新/删除                                           | 数据查询/更新/删除                   | 痛点：1、SDK（读取）方案待完善；2、大批量数据删除优化方案；3、数据更新优化方案。建议：1、继续优化SDK方案；2、设计大批量数据删除优化方案；3、设计数据更新优化方案。 | P1     |                           |
|                                        | 建表                                                         |                                      | 建表工具化                                                   | P2     |                           |
| 7                                      | 数据管理                                                     |                                      | 痛点：1、元数据管理；2、数据权限管理；建议：1、元数据与BDP极光打通；2、数据权限与BDP UGDAP打通 | P2     |                           |