```c++
contrib/poco/Net/include/Poco/Net/AbstractHTTPRequestHandler.h  contrib/poco/Net/include/Poco/Net/HTTPSessionFactory.h          contrib/poco/Net/include/Poco/Net/PartSource.h
contrib/poco/Net/include/Poco/Net/DNS.h                         contrib/poco/Net/include/Poco/Net/HTTPSessionInstantiator.h     contrib/poco/Net/include/Poco/Net/PartStore.h
contrib/poco/Net/include/Poco/Net/DatagramSocket.h              contrib/poco/Net/include/Poco/Net/HTTPStream.h                  contrib/poco/Net/include/Poco/Net/PollSet.h
contrib/poco/Net/include/Poco/Net/DatagramSocketImpl.h          contrib/poco/Net/include/Poco/Net/HTTPStreamFactory.h           contrib/poco/Net/include/Poco/Net/QuotedPrintableDecoder.h
contrib/poco/Net/include/Poco/Net/DialogSocket.h                contrib/poco/Net/include/Poco/Net/HostEntry.h                   contrib/poco/Net/include/Poco/Net/QuotedPrintableEncoder.h
contrib/poco/Net/include/Poco/Net/FTPClientSession.h            contrib/poco/Net/include/Poco/Net/ICMPClient.h                  contrib/poco/Net/include/Poco/Net/RawSocket.h
contrib/poco/Net/include/Poco/Net/FTPStreamFactory.h            contrib/poco/Net/include/Poco/Net/ICMPEventArgs.h               contrib/poco/Net/include/Poco/Net/RawSocketImpl.h
contrib/poco/Net/include/Poco/Net/FilePartSource.h              contrib/poco/Net/include/Poco/Net/ICMPPacket.h                  contrib/poco/Net/include/Poco/Net/RemoteSyslogChannel.h
contrib/poco/Net/include/Poco/Net/HTMLForm.h                    contrib/poco/Net/include/Poco/Net/ICMPPacketImpl.h              contrib/poco/Net/include/Poco/Net/RemoteSyslogListener.h
contrib/poco/Net/include/Poco/Net/HTTPAuthenticationParams.h    contrib/poco/Net/include/Poco/Net/ICMPSocket.h                  contrib/poco/Net/include/Poco/Net/SMTPChannel.h
contrib/poco/Net/include/Poco/Net/HTTPBasicCredentials.h        contrib/poco/Net/include/Poco/Net/ICMPSocketImpl.h              contrib/poco/Net/include/Poco/Net/SMTPClientSession.h
contrib/poco/Net/include/Poco/Net/HTTPBasicStreamBuf.h          contrib/poco/Net/include/Poco/Net/ICMPv4PacketImpl.h            contrib/poco/Net/include/Poco/Net/ServerSocket.h
contrib/poco/Net/include/Poco/Net/HTTPBufferAllocator.h         contrib/poco/Net/include/Poco/Net/IPAddress.h                   contrib/poco/Net/include/Poco/Net/ServerSocketImpl.h
contrib/poco/Net/include/Poco/Net/HTTPChunkedStream.h           contrib/poco/Net/include/Poco/Net/IPAddressImpl.h               contrib/poco/Net/include/Poco/Net/Socket.h
contrib/poco/Net/include/Poco/Net/HTTPClientSession.h           contrib/poco/Net/include/Poco/Net/MailMessage.h                 contrib/poco/Net/include/Poco/Net/SocketAcceptor.h
contrib/poco/Net/include/Poco/Net/HTTPCookie.h                  contrib/poco/Net/include/Poco/Net/MailRecipient.h               contrib/poco/Net/include/Poco/Net/SocketAddress.h
contrib/poco/Net/include/Poco/Net/HTTPCredentials.h             contrib/poco/Net/include/Poco/Net/MailStream.h                  contrib/poco/Net/include/Poco/Net/SocketAddressImpl.h
contrib/poco/Net/include/Poco/Net/HTTPDigestCredentials.h       contrib/poco/Net/include/Poco/Net/MediaType.h                   contrib/poco/Net/include/Poco/Net/SocketConnector.h
contrib/poco/Net/include/Poco/Net/HTTPFixedLengthStream.h       contrib/poco/Net/include/Poco/Net/MessageHeader.h               contrib/poco/Net/include/Poco/Net/SocketDefs.h
contrib/poco/Net/include/Poco/Net/HTTPHeaderStream.h            contrib/poco/Net/include/Poco/Net/MulticastSocket.h             contrib/poco/Net/include/Poco/Net/SocketImpl.h
contrib/poco/Net/include/Poco/Net/HTTPIOStream.h                contrib/poco/Net/include/Poco/Net/MultipartReader.h             contrib/poco/Net/include/Poco/Net/SocketNotification.h
contrib/poco/Net/include/Poco/Net/HTTPMessage.h                 contrib/poco/Net/include/Poco/Net/MultipartWriter.h             contrib/poco/Net/include/Poco/Net/SocketNotifier.h
contrib/poco/Net/include/Poco/Net/HTTPRequest.h                 contrib/poco/Net/include/Poco/Net/NTPClient.h                   contrib/poco/Net/include/Poco/Net/SocketReactor.h
contrib/poco/Net/include/Poco/Net/HTTPRequestHandler.h          contrib/poco/Net/include/Poco/Net/NTPEventArgs.h                contrib/poco/Net/include/Poco/Net/SocketStream.h
contrib/poco/Net/include/Poco/Net/HTTPRequestHandlerFactory.h   contrib/poco/Net/include/Poco/Net/NTPPacket.h                   contrib/poco/Net/include/Poco/Net/StreamSocket.h
contrib/poco/Net/include/Poco/Net/HTTPResponse.h                contrib/poco/Net/include/Poco/Net/NameValueCollection.h         contrib/poco/Net/include/Poco/Net/StreamSocketImpl.h
contrib/poco/Net/include/Poco/Net/HTTPServer.h                  contrib/poco/Net/include/Poco/Net/Net.h                         contrib/poco/Net/include/Poco/Net/StringPartSource.h
contrib/poco/Net/include/Poco/Net/HTTPServerConnection.h        contrib/poco/Net/include/Poco/Net/NetException.h                contrib/poco/Net/include/Poco/Net/TCPServer.h
contrib/poco/Net/include/Poco/Net/HTTPServerConnectionFactory.h contrib/poco/Net/include/Poco/Net/NetworkInterface.h            contrib/poco/Net/include/Poco/Net/TCPServerConnection.h
contrib/poco/Net/include/Poco/Net/HTTPServerParams.h            contrib/poco/Net/include/Poco/Net/NullPartHandler.h             contrib/poco/Net/include/Poco/Net/TCPServerConnectionFactory.h
contrib/poco/Net/include/Poco/Net/HTTPServerRequest.h           contrib/poco/Net/include/Poco/Net/OAuth10Credentials.h          contrib/poco/Net/include/Poco/Net/TCPServerDispatcher.h
contrib/poco/Net/include/Poco/Net/HTTPServerRequestImpl.h       contrib/poco/Net/include/Poco/Net/OAuth20Credentials.h          contrib/poco/Net/include/Poco/Net/TCPServerParams.h
contrib/poco/Net/include/Poco/Net/HTTPServerResponse.h          contrib/poco/Net/include/Poco/Net/POP3ClientSession.h           contrib/poco/Net/include/Poco/Net/WebSocket.h
contrib/poco/Net/include/Poco/Net/HTTPServerResponseImpl.h      contrib/poco/Net/include/Poco/Net/ParallelSocketAcceptor.h      contrib/poco/Net/include/Poco/Net/WebSocketImpl.h
contrib/poco/Net/include/Poco/Net/HTTPServerSession.h           contrib/poco/Net/include/Poco/Net/ParallelSocketReactor.h
contrib/poco/Net/include/Poco/Net/HTTPSession.h                 contrib/poco/Net/include/Poco/Net/PartHandler.h
  

class Net_API Socket
	/// Socket is the common base class for
	/// StreamSocket, ServerSocket, DatagramSocket and other
	/// socket classes.

class Net_API ServerSocket: public Socket
	/// This class provides an interface to a
	/// TCP server socket.

class Net_API TCPServer: public Poco::Runnable
	/// This class implements a multithreaded TCP server.
	///
	/// The server uses a ServerSocket to listen for incoming
	/// connections. The ServerSocket must have been bound to
	/// an address before it is passed to the TCPServer constructor.
	/// Additionally, the ServerSocket must be put into listening
	/// state before the TCPServer is started by calling the start()
	/// method.
The TCPServer Framework (cont'd)
> The number of connections in the queue can be limited to prevent the server from being flooded with requests. Incoming connections that no longer fit into the queue are closed immediately.
> TCPServer creates its own thread that accepts connections and places them in the queue.
> TCPServer uses TCPServerConnection objects to handle a connection. You must create your own subclass of
TCPServerConnection, as well as a factory for it. The factory object is passed to the constructor of TCPServer.
                         
The TCPServer Framework (cont'd)
> Your subclass of TCPServerConnection must override the run() method. In the run() method, you handle the connection.
> When run() returns, the TCPServerConnection object will be deleted, and the connection closed.
> A new TCPServerConnection will be created for every accepted connection.
 
                         
                       

class Net_API HTTPServer: public TCPServer
   /// A subclass of TCPServer that implements a
   /// full-featured multithreaded HTTP server.
   ///
   /// A HTTPRequestHandlerFactory must be supplied.
   /// The ServerSocket must be bound and in listening state.
   ///
   /// To configure various aspects of the server, a HTTPServerParams
   /// object can be passed to the constructor.
   ///
   /// The server supports:
   ///   - HTTP/1.0 and HTTP/1.1
   ///   - automatic handling of persistent connections.
   ///   - automatic decoding/encoding of request/response message bodies
   ///     using chunked transfer encoding.
                         
                         
                         
                         
 class TCPHandler : public Poco::Net::TCPServerConnection
{
public:
    /** parse_proxy_protocol_ - if true, expect and parse the header of PROXY protocol in every connection
      * and set the information about forwarded address accordingly.
      * See https://github.com/wolfeidau/proxyv2/blob/master/docs/proxy-protocol.txt
      *
      * Note: immediate IP address is always used for access control (accept-list of IP networks),
      *  because it allows to check the IP ranges of the trusted proxy.
      * Proxy-forwarded (original client) IP address is used for quota accounting if quota is keyed by forwarded IP.
      */
    TCPHandler(IServer & server_, const Poco::Net::StreamSocket & socket_, bool parse_proxy_protocol_)
        : Poco::Net::TCPServerConnection(socket_)
        , server(server_)
        , parse_proxy_protocol(parse_proxy_protocol_)
        , log(&Poco::Logger::get("TCPHandler"))
        , connection_context(server.context())
        , query_context(server.context())
    {
        server_display_name = server.config().getString("display_name", getFQDNOrHostName());
    }

    void TCPHandler::run()
    {
        try
        {
            runImpl();

            LOG_DEBUG(log, "Done processing connection.");
        }
        catch (Poco::Exception & e)
        {
            /// Timeout - not an error.
            if (!strcmp(e.what(), "Timeout"))
            {
                LOG_DEBUG(log, "Poco::Exception. Code: {}, e.code() = {}, e.displayText() = {}, e.what() = {}", ErrorCodes::POCO_EXCEPTION, e.code(), e.displayText(), e.what());
            }
            else
                throw;
        }
    }

}
                         
                         
                         
class TCPHandlerFactory : public Poco::Net::TCPServerConnectionFactory
{
private:
    IServer & server;
    bool parse_proxy_protocol = false;
    Poco::Logger * log;

    class DummyTCPHandler : public Poco::Net::TCPServerConnection
    {
    public:
        using Poco::Net::TCPServerConnection::TCPServerConnection;
        void run() override {}
    };

public:
    /** parse_proxy_protocol_ - if true, expect and parse the header of PROXY protocol in every connection
      * and set the information about forwarded address accordingly.
      * See https://github.com/wolfeidau/proxyv2/blob/master/docs/proxy-protocol.txt
      */
    TCPHandlerFactory(IServer & server_, bool secure_, bool parse_proxy_protocol_)
        : server(server_), parse_proxy_protocol(parse_proxy_protocol_)
        , log(&Poco::Logger::get(std::string("TCP") + (secure_ ? "S" : "") + "HandlerFactory"))
    {
    }

    Poco::Net::TCPServerConnection * createConnection(const Poco::Net::StreamSocket & socket) override
    {
        try
        {
            LOG_TRACE(log, "TCP Request. Address: {}", socket.peerAddress().toString());

            // use TCPHandler
            return new TCPHandler(server, socket, parse_proxy_protocol);
        }
        catch (const Poco::Net::NetException &)
        {
            LOG_TRACE(log, "TCP Request. Client is not connected (most likely RST packet was sent).");
            return new DummyTCPHandler(socket);
        }
    }
};
                         
                         

```